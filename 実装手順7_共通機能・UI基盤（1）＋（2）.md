## 共通機能・UI基盤（1）＋（2） 実装手順（初心者向け）

---

## 📚 このガイドについて

このガイドは、**2/11（水）：共通機能・UI基盤（1）＋（2）** の作業を、**プログラミング初心者の方でも迷わずに進められるように**、丁寧にステップごとに説明したものです。

**所要時間の目安**: 約4〜5時間（初めての場合）

- Tailwind CSS のレイアウト設定  
- レスポンシブ対応（スマホ・タブレット・PC）  
- 共通レイアウト（ヘッダー／フッター／ページ全体レイアウト）  
- ボタン・入力フォームなどの共通コンポーネント  
- 会員向けの「ユーザー情報ページ」  
- 管理者向けの「ユーザー一覧ページ（基本）」  

を順番に作っていきます。

---

## 📖 用語集（最初に読んでおくと理解が深まります）

### レイアウト・UIに関する用語

- **レイアウト**: 画面全体の「枠組み」のこと。ヘッダー・フッター・メインコンテンツの配置など。
- **レスポンシブデザイン**: スマホ・タブレット・PC など、画面の大きさに合わせてレイアウトを自動で調整するデザインのこと。
- **ブレークポイント（breakpoint）**: 画面幅の「切り替えポイント」のこと。例：`md` は「幅768px以上のとき」のスタイル。
- **コンポーネント**: ボタンやヘッダーなど、UIの「部品」のこと。1つ作っておくと、いろいろなページで再利用できます。

### Tailwind CSS に関する用語

- **ユーティリティクラス**: `bg-gray-800` や `text-center` など、1つの役割だけを持つ小さなCSSクラスのこと。
- **コンテナ（container）**: ページの横幅を中央にまとめるためのクラス。`container mx-auto px-4` など。
- **余白（padding / margin）**:  
  - `p-4` = 全ての方向に余白をつける  
  - `px-4` = 左右に余白  
  - `py-4` = 上下に余白  

### ページ・レイアウトに関する用語

- **レイアウトコンポーネント**: 全ページで共通して使う「外側の枠」のコンポーネント。`Header`・`Footer`・`main`などをまとめたもの。
- **ユーザー情報ページ**: ログインしたユーザー本人が、自分の名前やメールアドレスなどを確認・編集できるページ。
- **管理者用ユーザー一覧ページ**: 管理者が、登録されているユーザーの一覧を確認するためのページ（最初は「表示だけ」のシンプルなもの）。

---

## 📋 今日（2/11）の作業内容

開発スケジュールの  
**「2/11（水）：共通機能・UI基盤（1）＋（2）」** を完了するための、ステップバイステップガイドです。

### 🎯 目標

1. **全ページで共通のレイアウト**（ヘッダー・フッター・メインコンテンツ）がきれいに表示される  
2. **スマホ〜PCまでレスポンシブ対応**のレイアウトができている  
3. **共通のボタン・入力フォームコンポーネント**が使えるようになっている  
4. **会員用のユーザー情報ページ**と、**管理者用のユーザー一覧ページ（基本）**が表示できる  

---

## ✅ ステップ1: Tailwind CSS のレイアウト・ブレークポイントの理解

### 1-1. すでに入っている Tailwind の設定を確認

1. VSCode でプロジェクトを開く  
2. 左のエクスプローラーから `frontend/app/globals.css` を開きます  

現在の内容は次のようになっています（抜粋）：

```typescript
@import "tailwindcss";

:root {
  --background: #ffffff;
  --foreground: #171717;
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
}

@media (prefers-color-scheme: dark) {
  :root {
    --background: #0a0a0a;
    --foreground: #ededed;
  }
}

body {
  background: var(--background);
  color: var(--foreground);
  font-family: Arial, Helvetica, sans-serif;
}
```

この状態でも Tailwind のユーティリティクラス（`bg-...` や `flex` など）はすでに使えています。  
（`Header.tsx` や `Footer.tsx` で `bg-white` や `container` を使っているのが確認できます）

**現在の状態**: ✅ Tailwind CSS の基本設定はすでに入っている

---

### 1-2. ブレークポイント（スマホ／PC切り替え）の考え方

Tailwind では、以下のような**ブレークポイント**がよく使われます（デフォルト値）：

- `sm` : 640px 以上  
- `md` : 768px 以上（タブレット〜）  
- `lg` : 1024px 以上（PC〜）  

クラス名の前に `md:` をつけると、  
**「画面幅が md 以上のときだけ、そのスタイルを有効にする」**という意味になります。

例：

```tsx
<div className="bg-white md:bg-blue-100">
  {/* スマホ：白背景、md以上：水色背景 */}
</div>
```

`Header.tsx` でも、すでに次のように使われています：

```tsx
<div className="hidden md:flex items-center space-x-6">
  {/* 画面が md 以上のときだけ表示されるメニュー */}
</div>
```

**ポイント**:

- `hidden md:flex` → スマホでは非表示、タブレット以上で表示  
- `md:grid-cols-3` → タブレット以上で3列レイアウトにする  

**現在の状態**: ✅ ブレークポイントの基本的な使い方が分かった

---

## ✅ ステップ2: 共通レイアウト（全ページの枠組み）を確認・整理

### 2-1. レイアウトコンポーネントとは？

レイアウトコンポーネントは、**全ページ共通の外側の枠**を作るためのコンポーネントです。

このプロジェクトでは、すでに `frontend/app/layout.tsx` がレイアウトコンポーネントの役割を持っています。

`frontend/app/layout.tsx` を開いて、内容を確認します：

```typescript
import type { Metadata } from "next";
import { Inter } from "next/font/google";
import "./globals.css";
import Header from "@/components/Header";
import Footer from "@/components/Footer";
import Providers from "@/components/Providers";

const inter = Inter({ subsets: ["latin"] });

export const metadata: Metadata = {
  title: "サッカー教室 | ホームページ",
  description: "子供たちの可能性を広げるサッカー教室です",
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="ja">
      <body className={inter.className}>
        <Providers>
          <div className="flex flex-col min-h-screen">
            <Header />
            <main className="flex-grow">
              {children}
            </main>
            <Footer />
          </div>
        </Providers>
      </body>
    </html>
  );
}
```

**ポイント**:

- `<Header />` と `<Footer />` が全ページ共通で表示される
- `<main className="flex-grow">` の中に、各ページ (`page.tsx` など) の内容が入る
- `flex flex-col min-h-screen` で、**画面全体の高さを確保しつつ、ヘッダー／フッター＋メイン**の縦並びレイアウトになっている

**現在の状態**: ✅ 共通レイアウト（ヘッダー・フッター・メイン枠）が整っている

---

### 2-2. レイアウトの余白・幅をそろえる

各ページの中身（`app/page.tsx` や `app/about/page.tsx` など）でも、  
`container mx-auto px-4 py-8` のようなクラスを使うことで、**中央寄せ＋余白**を簡単にそろえることができます。

例として、トップページ `frontend/app/page.tsx` を次のような形にしておくと分かりやすいです：

```tsx
export default function HomePage() {
  return (
    <div className="container mx-auto px-4 py-16">
      <div className="max-w-4xl mx-auto">
        <h1 className="text-3xl md:text-4xl font-bold mb-6 text-gray-900">
          サッカー教室へようこそ！
        </h1>
        <p className="text-gray-700 leading-relaxed">
          ここに教室の紹介文が入ります。スマホでもPCでも見やすいようにレイアウトされています。
        </p>
      </div>
    </div>
  );
}
```

**ポイント**:

- `container mx-auto` : コンテンツを中央寄せ＆最大幅を自動で調整  
- `px-4` : 左右の余白（スマホで読みやすくするため）  
- `py-16` : 上下の余白（セクション間の空間を確保）  
- `max-w-4xl mx-auto` : 真ん中に幅を制限した箱を作る  

**現在の状態**: ✅ 各ページの中身も、統一されたレイアウトで書けるようになった

---

## ✅ ステップ3: 共通UIコンポーネント（ボタン・入力フォーム）の整備

### 3-1. ボタンコンポーネントの確認・作成

1. `frontend/components/Button.tsx` を開きます  
2. もし中身がまだシンプル／未整備であれば、次のように更新します：

```tsx
'use client'

type ButtonProps = React.ButtonHTMLAttributes<HTMLButtonElement> & {
  variant?: 'primary' | 'secondary'
}

export default function Button({
  children,
  variant = 'primary',
  className = '',
  ...props
}: ButtonProps) {
  const baseClass =
    'inline-flex items-center justify-center rounded-lg font-semibold focus:outline-none focus:ring-2 focus:ring-offset-2 transition'

  const variantClass =
    variant === 'primary'
      ? 'bg-green-600 text-white hover:bg-green-700 focus:ring-green-500'
      : 'bg-white text-green-600 border border-green-600 hover:bg-green-50 focus:ring-green-500'

  return (
    <button
      className={`${baseClass} ${variantClass} px-4 py-2 ${className}`}
      {...props}
    >
      {children}
    </button>
  )
}
```

**ポイント**:

- `variant="primary"` で「メインボタン」、`variant="secondary"` で「サブボタン」を表現  
- クラスをひとまとめにしておくことで、**どのページでも同じ見た目のボタン**が使える  

#### 使い方（例）

```tsx
import Button from '@/components/Button'

export default function Example() {
  return (
    <div className="space-x-4">
      <Button onClick={() => alert('クリックされました！')}>
        予約する
      </Button>
      <Button variant="secondary">
        キャンセル
      </Button>
    </div>
  )
}
```

**現在の状態**: ✅ 共通ボタンコンポーネントが使えるようになった

---

### 3-2. 入力フォームコンポーネントの作成

フォームを毎回1から書くと大変なので、**共通の入力コンポーネント**を作ります。

1. `frontend/components` フォルダに `Input.tsx` を新規作成します  
2. 次のコードを追加します：

```tsx
'use client'

type InputProps = React.InputHTMLAttributes<HTMLInputElement> & {
  label: string
  error?: string
}

export default function Input({ label, error, ...props }: InputProps) {
  return (
    <div className="space-y-1">
      <label className="block text-sm font-medium text-gray-700">
        {label}
      </label>
      <input
        className={`
          block w-full rounded-md border px-3 py-2 shadow-sm 
          focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500
          ${error ? 'border-red-500' : 'border-gray-300'}
        `}
        {...props}
      />
      {error && (
        <p className="text-xs text-red-500">
          {error}
        </p>
      )}
    </div>
  )
}
```

#### 使い方（例）

```tsx
import Input from '@/components/Input'

export default function ExampleForm() {
  return (
    <form className="space-y-4">
      <Input
        label="お名前"
        name="name"
        placeholder="山田 太郎"
      />
      <Input
        label="メールアドレス"
        name="email"
        type="email"
        placeholder="example@example.com"
      />
    </form>
  )
}
```

**現在の状態**: ✅ 共通の入力フォームコンポーネントが作成された

---

## ✅ ステップ4: ヘッダー／フッターのレスポンシブとデザイン確認

### 4-1. ヘッダーの確認（`Header.tsx`）

`frontend/components/Header.tsx` は、すでにレスポンシブ対応された実装になっています。

主なポイント：

- `md:flex` と `md:hidden` を使って、**PC とスマホで表示を切り替え**ている
- ログイン状態によって、**「ログイン」ボタン or 「ユーザー名＋ログアウト」ボタン**を切り替えている
- メニューは `Link` コンポーネントでルーティング済み（`/`, `/about`, `/contact`, `/login`）

もし、ヘッダーのデザインを少し整えたい場合は、例えば次のようにクラスを調整してもOKです（イメージ）：

```tsx
<header className="bg-white shadow-md sticky top-0 z-50">
  <nav className="container mx-auto px-4 py-3 flex items-center justify-between">
    {/* ロゴ・メニュー …（既存のコードをそのまま利用） */}
  </nav>
</header>
```

**現在の状態**: ✅ レスポンシブ対応のヘッダーができている

---

### 4-2. フッターの確認（`Footer.tsx`）

`frontend/components/Footer.tsx` も、すでに3カラムレイアウト＋レスポンシブ対応になっています。

- `grid grid-cols-1 md:grid-cols-3`  
  → スマホでは1列、`md`以上では3列に並ぶ
- `bg-gray-800 text-white`  
  → ダークな背景でコントラストのあるフッター

必要であれば、テキストや連絡先情報を実際の内容に変更してください。

**現在の状態**: ✅ レスポンシブなフッターが整っている

---

## ✅ ステップ5: 会員用「ユーザー情報ページ」の作成

ここから「ユーザー情報まわり」のページを作っていきます。  
まずは**会員（ログイン済みユーザー）が自分の情報を確認・編集できるページ**を作ります。

### 5-1. ページファイルの作成

1. `frontend/app` フォルダを右クリック  
2. 新しいフォルダを作成 → 名前を `member` にします  
3. `member` フォルダの中に `page.tsx` ファイルを作成します  

### 5-2. 認証ガードを使ったページの実装

`frontend/app/member/page.tsx` に、次のコードを追加します：

```tsx
import AuthGuard from '@/components/AuthGuard'
import { useSession } from 'next-auth/react'

export default function MemberPage() {
  return (
    <AuthGuard>
      <MemberContent />
    </AuthGuard>
  )
}

function MemberContent() {
  const { data: session } = useSession()

  return (
    <div className="container mx-auto px-4 py-16">
      <div className="max-w-2xl mx-auto space-y-8">
        <h1 className="text-3xl font-bold text-gray-900">
          会員情報
        </h1>

        <div className="bg-white p-6 rounded-lg shadow-md space-y-4">
          <div>
            <h2 className="text-xl font-semibold mb-2">基本情報</h2>
            <p className="text-gray-700">
              お名前: {session?.user?.name || '未設定'}
            </p>
            <p className="text-gray-700">
              メールアドレス: {session?.user?.email || '未設定'}
            </p>
          </div>
        </div>
      </div>
    </div>
  )
}
```

**ポイント**:

- `<AuthGuard>` でラップすることで、**ログインしていないユーザーは `/login` にリダイレクト**されます  
- `useSession()` で、ログイン中のユーザー情報（`session.user.name` など）を取得  

**現在の状態**: ✅ 会員専用の「ユーザー情報ページ」が表示できるようになった

---

### 5-3. ユーザー情報編集フォーム（簡易版）の追加（オプション）

まずは表示だけでもOKですが、余裕があれば**名前やメールアドレスを編集するフォーム**も追加してみましょう。  
（この段階では「見た目を作るだけ」で大丈夫です。保存処理は後日のステップでも構いません）

`MemberContent` 内に、先ほど作った `Input` コンポーネントと `Button` を使って、次のようなフォームを追加できます：

```tsx
import Input from '@/components/Input'
import Button from '@/components/Button'

// MemberContent の return 内で、下記のようなフォームを追加
<div className="bg-white p-6 rounded-lg shadow-md space-y-4">
  <h2 className="text-xl font-semibold mb-2">プロフィール編集（見た目だけ）</h2>
  <form className="space-y-4">
    <Input
      label="お名前"
      name="name"
      defaultValue={session?.user?.name || ''}
      placeholder="山田 太郎"
    />
    <Input
      label="メールアドレス"
      name="email"
      type="email"
      defaultValue={session?.user?.email || ''}
      placeholder="example@example.com"
    />
    <Button type="button">
      保存（あとで実装）
    </Button>
  </form>
</div>
```

**現在の状態**: ✅ ユーザー情報の「表示＋フォームの見た目」まで完成（保存処理は後日でOK）

---

## ✅ ステップ6: 管理者用「ユーザー一覧ページ（基本）」の作成

ここでは、**まずは「デザイン・レイアウトだけ」**を作ります。  
後で Supabase と接続して本物のデータを表示する予定です（この日はダミーデータでOK）。

### 6-1. ページファイルの作成

1. `frontend/app` フォルダに、新しく `admin` フォルダを作成  
2. `frontend/app/admin/page.tsx` を作成  

### 6-2. ユーザー一覧ページの基本レイアウト

`frontend/app/admin/page.tsx` に、次のコードを追加します：

```tsx
import AuthGuard from '@/components/AuthGuard'
import { auth } from '@/app/api/auth/[...nextauth]/route'
import { redirect } from 'next/navigation'

export default async function AdminPage() {
  const session = await auth()

  // （簡易版）ここでは「ログインしていれば誰でも見られる」状態
  // 後で「管理者だけが見られるようにする」処理を追加予定です
  if (!session) {
    redirect('/login')
  }

  return (
    <div className="container mx-auto px-4 py-16">
      <div className="max-w-4xl mx-auto space-y-8">
        <h1 className="text-3xl font-bold text-gray-900">
          ユーザー一覧（管理画面・デザイン確認用）
        </h1>

        <div className="bg-white shadow-md rounded-lg overflow-hidden">
          <table className="min-w-full divide-y divide-gray-200">
            <thead className="bg-gray-50">
              <tr>
                <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  ID
                </th>
                <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  名前
                </th>
                <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  メールアドレス
                </th>
              </tr>
            </thead>
            <tbody className="bg-white divide-y divide-gray-200">
              {/* ここではダミーデータを表示（後でSupabaseと接続） */}
              <tr>
                <td className="px-4 py-3 text-sm text-gray-900">1</td>
                <td className="px-4 py-3 text-sm text-gray-900">山田 太郎</td>
                <td className="px-4 py-3 text-sm text-gray-500">taro@example.com</td>
              </tr>
              <tr>
                <td className="px-4 py-3 text-sm text-gray-900">2</td>
                <td className="px-4 py-3 text-sm text-gray-900">佐藤 花子</td>
                <td className="px-4 py-3 text-sm text-gray-500">hanako@example.com</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  )
}
```

**ポイント**:

- `auth()` と `redirect('/login')` を使って、**サーバー側でログインチェック**を行っています  
- `table`＋`divide-y` クラスで、**シンプルな一覧表レイアウト**を作成  
- 今はダミーデータですが、後で Supabase の `users` テーブルと接続して本物のデータを表示します  

**現在の状態**: ✅ 管理用の「ユーザー一覧ページ（基本デザイン）」が表示できるようになった

---

## ✅ ステップ7: 動作確認

### 7-1. 開発サーバーの起動

1. ターミナルを開く  
2. 次のコマンドを実行：

```bash
cd frontend
npm run dev
```

3. `Local: http://localhost:3000` と表示されればOKです

---

### 7-2. レイアウトとレスポンシブの確認

1. ブラウザで `http://localhost:3000` を開く  
2. 画面の幅を**スマホサイズ（幅を細く）／PCサイズ（幅を広く）**に変えて、以下を確認：
   - ヘッダーのメニューが  
     - スマホ：ハンバーガーメニュー（☰）になる  
     - PC：横並びのメニューになる  
   - フッターが  
     - スマホ：1列表示  
     - PC：3列表示  

---

### 7-3. ユーザー情報ページの確認

1. まず、`/login` から LINE ログインして、ログイン状態にします  
2. ブラウザで `http://localhost:3000/member` にアクセス  
3. 以下を確認します：
   - ログインしていない場合は、自動的に `/login` にリダイレクトされる  
   - ログインしている場合：  
     - 「会員情報」のページが表示される  
     - 名前・メールアドレスが表示されている（もしくは「未設定」と表示される）  
     - （オプションで追加した場合）フォームが表示されている  

---

### 7-4. 管理者用ユーザー一覧ページの確認（デザインのみ）

1. ログインした状態で、`http://localhost:3000/admin` にアクセス  
2. 以下を確認します：
   - ログインしていない場合 → `/login` にリダイレクトされる  
   - ログインしている場合 → 「ユーザー一覧」のテーブルが表示される  
   - スマホ／PCでレイアウトが崩れていないか確認する  

---

## ✅ 完了チェックリスト

以下のチェックがすべて ✅ になれば、**「2/11（水）：共通機能・UI基盤（1）＋（2）」は完了**です！

- [ ] Tailwind CSS のレイアウトとブレークポイントの仕組みが理解できた  
- [ ] 共通レイアウト（`layout.tsx`）で、ヘッダー・フッター・メインの枠組みが整っている  
- [ ] 各ページで `container` / `px-4` / `py-16` などを使って、余白と幅がそろっている  
- [ ] 共通の `Button` コンポーネントが作成され、どのページでも使える  
- [ ] 共通の `Input` コンポーネントが作成され、フォームの見た目が統一されている  
- [ ] 会員用「ユーザー情報ページ」 (`/member`) が表示できる  
- [ ] （オプション）ユーザー情報編集フォームの見た目ができている  
- [ ] 管理者用「ユーザー一覧ページ（基本）」 (`/admin`) が表示できる  
- [ ] スマホ／PC どちらでもレイアウトが見やすく表示される  

---

## 📝 次のステップ

次回の予定（例）：

- ユーザー情報編集フォームの「保存処理」の実装（Supabase連携）  
- 管理者用ユーザー一覧ページで、実際の `users` テーブルのデータを表示  
- 管理者だけが `/admin` にアクセスできるように権限チェックを追加  

詳細は `開発スケジュール.md` をあわせて確認してください。

---

## ⚠️ トラブルシューティング

### エラー1: ページが真っ白で何も表示されない

**原因の例**:

- コンポーネント内でエラーが発生している  
- `export default function` を書き忘れている  

**確認方法**:

1. ブラウザの開発者ツール（F12）を開き、「Console」タブをチェック  
2. エラーメッセージが出ていないか確認  

**よくあるミス**:

- `return ( ... )` のカッコの閉じ忘れ  
- `import` 文のパスミス（`@/components/...` のスペルミスなど）  

---

### エラー2: 「useSession must be used within a SessionProvider」と表示される

**原因**:

- `useSession` を使っているコンポーネントが、`SessionProvider` の外にある  

**解決方法**:

1. `frontend/components/Providers.tsx` が次のようになっているか確認：

```tsx
'use client'

import { SessionProvider } from 'next-auth/react'

export default function Providers({ children }: { children: React.ReactNode }) {
  return <SessionProvider>{children}</SessionProvider>
}
```

2. `frontend/app/layout.tsx` で、`<Providers>` で全体をラップしているか確認：

```tsx
<body className={inter.className}>
  <Providers>
    {/* ここにHeader / main / Footer が入っている */}
  </Providers>
</body>
```

---

### エラー3: `/member` や `/admin` にアクセスするとエラーになる

**原因の例**:

- ファイルパス・ファイル名が間違っている（`member/page.tsx` になっていない 等）  
- `import` のパスが間違っている（`'@/components/AuthGuard'` など）  
- サーバーコンポーネントで `useSession` を使ってしまっている  

**チェックポイント**:

- `member/page.tsx` の一番上は「クライアントコンポーネント」ではなく、`AuthGuard` 内で `useSession` を使う構成になっているか  
- `admin/page.tsx` は `async function AdminPage()` としてサーバーコンポーネントにしているか  

---

### エラー4: レイアウトが崩れて見える

**原因の例**:

- `container` や `px-4` を付け忘れている  
- 不要な `h-screen` などで高さが固定されている  

**解決方法**:

1. ページの一番外側を次のように統一してみる：

```tsx
<div className="container mx-auto px-4 py-16">
  <div className="max-w-4xl mx-auto">
    {/* コンテンツ */}
  </div>
  </div>
```

2. スマホサイズで確認しながら、`px-4` や `py-8` を調整する  

---

## 📞 参考リンク

- **Tailwind CSS 公式ドキュメント**: `https://tailwindcss.com/docs`  
- **Next.js App Router ドキュメント**: `https://nextjs.org/docs/app`  
- **NextAuth.js 公式ドキュメント**: `https://next-auth.js.org/`  
- **Auth.js (NextAuth v5) ドキュメント**: `https://authjs.dev/`  

---

**最終更新**: 2026年2月11日  
**対象**: プログラミング初心者の方

